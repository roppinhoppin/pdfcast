# A RE ADVERSARIAL EXAMPLES INEVITABLE ?  

Ali Shafahi, Ronny Huang, Christoph Studer, Soheil Feizi & Tom Goldstein  

# A BSTRACT  

A wide range of defenses have been proposed to harden neural networks against adversarial attacks. However, a pattern has emerged in which the majority of adversarial defenses are quickly broken by new attacks. Given the lack of success at generating robust defenses, we are led to ask a fundamental question: Are adversarial attacks inevitable? This paper analyzes adversarial examples from a theoretical perspective, and identifies fundamental bounds on the susceptibility of a classifier to adversarial attacks. We show that, for certain classes of problems, adversarial examples are inescapable. Using experiments, we explore the implications of theoretical guarantees for real-world problems and discuss how factors such as dimensionality and image complexity limit a classifier’s robustness against adversarial examples.  

# 1 I NTRODUCTION  

A number of adversarial attacks on neural networks have been recently proposed. To counter these attacks, a number of authors have proposed a range of defenses. However, these defenses are often quickly broken by new and revised attacks. Given the lack of success at generating robust defenses, we are led to ask a fundamental question: Are adversarial attacks inevitable?  

In this paper, we identify a broad class of problems for which adversarial examples cannot be avoided. We also derive fundamental limits on the susceptibility of a classifier to adversarial attacks that depend on properties of the data distribution as well as the dimensionality of the dataset.  

Adversarial examples occur when a small perturbation to an image changes its class label. There are different ways of measuring what it means for a perturbation to be “small”; as such, our analysis considers a range of different norms. While the $\ell_{\infty}$ -norm is commonly used, adversarial examples can be crafted in any $\ell_{p}$ -norm (see Figure 1). We will see that the choice of norm can have a dramatic effect on the strength of theoretical guarantees for the existence of adversarial examples. Our analysis also extends to the $\ell_{0}$ -norm, which yields “sparse” adversarial examples that only perturb a small subset of image pixels (Figure 2).  

As a simple example result, consider a classification problem with $n$ -dimensional images with pixels scaled between 0 and 1 (in this case images live inside the unit hypercube). If the image classes each occupy a fraction of the cube greater than $\textstyle{\frac{1}{2}}\exp(-\pi\epsilon^{2})$ , then images exist that are susceptible to adversarial perturbations of $\ell_{2}$ -norm at most $\epsilon$ . Note that $\epsilon=10$ was used in Figure 1, and larger values are typical for larger images.  

![](images/201e9dc3d601b3a8d1b3a52788684504d7934940ef9c1d5f8973f4171c31f534.jpg)  
Figure 1: Adversarial examples with different norm constraints formed via the projected gradient method (Madry et al., 2017) on Resnet50, along with the distance between the base image and the adversarial example, and the top class label.  

Finally, in Section 8, we explore the causes of adversarial susceptibility in real datasets, and the effect of dimensionality. We present an example image class for which there is no fundamental link between dimensionality and robustness, and argue that the data distribution, and not dimensionality, is the primary cause of adversarial susceptibility.  

# 1.1BACKGROUND: ABRIEF HISTORY OF ADVERSARIAL EXAMPLES  

Adversarial examples, first demonstrated in Szegedy et al. (2013) and Biggio et al. (2013), change the label of an image using small and often imperceptible perturbations to its pixels. A number of defenses have been proposed to harden networks against attacks, but historically, these defenses have been quickly broken. Adversarial training , one of the earliest defenses, successfully thwarted the fast gradient sign method (FGSM) (Goodfellow et al., 2014), one of the earliest and simplest attacks. However, adversarial training with FGSM examples was quickly shown to be vulnerable to more sophisticated multi-stage attacks (Kurakin et al., 2016; Tram\`er et al., 2017a). More sophisticated defenses that rely on network distillation (Papernot et al., 2016b) and specialized activation functions (Zantedeschi et al., 2017) were also toppled by strong attacks (Papernot et al., 2016a; Tram\`er et al., 2017b; Carlini & Wagner, 2016; 2017a).  

The ongoing vulnerability of classifiers was highlighted in recent work by Athalye et al. (2018) and Athalye & Sutskever (2017) that broke an entire suite of defenses presented in ICLR 2018 including thermometer encoding (Buckman et al., 2018), detection using local intrinsic dimensionality (Ma et al., 2018), input transformations such as compression and image quilting (Guo et al., 2017), stochastic activation pruning (Dhillon et al., 2018), adding randomization at inference time (Xie et al., 2017), enhancing the confidence of image labels (Song et al., 2017), and using a generative model as a defense (Samangouei et al., 2018).  

Rather than hardening classifiers to attacks, some authors have proposed sanitizing datasets to remove adversarial perturbations before classification. Approaches based on auto-encoders (Meng & Chen, 2017) and GANs (Shen et al., 2017) were broken using optimization-based attacks (Carlini & Wagner, 2017b;a).  

A number of “certifiable” defense mechanisms have been developed for certain classifiers. Raghunathan et al. (2018) harden a two-layer classifier using semidefinite programming, and Sinha et al. (2018) propose a convex duality-based approach to adversarial training that works on sufficiently small adversarial perturbations with a quadratic adversarial loss. Kolter & Wong (2017) consider training a robust classifier using the convex outer adversarial polytope. All of these methods only consider robustness of the classifier on the training set, and robustness properties often fail to generalize reliably to test examples.  

One place where researchers have enjoyed success is at training classifiers on low-dimensional datasets like MNIST (Madry et al., 2017; Sinha et al., 2018). The robustness achieved on more complicated datasets such as CIFAR-10 and ImageNet are nowhere near that of MNIST, which leads some researchers to speculate that adversarial defense is fundamentally harder in higher dimensions – an issue we address in Section 8.  

![](images/6f6dba5bb132f5b60f83aee4da61bc18c8e4dec852071e22f412c3f7dc211ace.jpg)  
Figure 2: Sparse adversarial examples perturb a small subset of pixels and can hide adversarial “fuzz” inside highfrequency image regions. The original image (left) is classified as an “ox.” Under $\ell_{\infty}$ -norm perturbations, it is classified as “traffic light”, but the perturbations visibly distort smooth regions of the image (the sky). These effects are hidden in the grass using $\ell_{0}$ -norm (sparse) perturbations limited to a small subset of pixels.  

This paper uses well-known results from high-dimensional geometry, specifically isoperimetric inequalities, to provide bounds on the robustness of classifiers. Several other authors have investigated adversarial susceptibility through the lens of geometry. Wang et al. (2018) analyze the robustness of nearest neighbor classifiers, and provide a more robust NN classifier. Fawzi et al. (2018) study adversarial susceptibility of datasets under the assumption that they are produced by a generative model that maps random Gaussian vectors onto images. Gilmer et al. (2018) do a detailed case study, including empirical and theoretical results, of classifiers for a synthetic dataset that lies on two concentric spheres. Simon-Gabriel et al. (2018) show that the Lipschitz constant of untrained networks with random weights gets large in high dimensions. Shortly after the original appearance of our work, Mahloujifar et al. (2018) presented a study of adversarial susceptibility that included both evasion and poisoning attacks. Our work is distinct in that it studies adversarial robustness for arbitrary data distributions, and also that it rigorously looks at the effect of dimensionality on robustness limits.  

# 1.2 NOTATION  

We use $[0,1]^{n}$ to denote the unit hypercub $n$ nsions, a $\operatorname{vol}(A)$ e (i.e., ndimensional Lebesgue measu the unit sphere embe be quantified by its ( $(n-1$ −ndimensional) measure R$\mathbb{R}^{n}$ of a ,and $s_{n-1}$ −tto deno A ⊂ $A\subset[0,1]^{n}$ $\mu[A]$ A surface area. The size of a subset . We use ,whic is simply the surface area the set covers. $\mathbb{S}^{n-1}=\{x\in\mathbb{R}^{n}|\,\|x\|_{2}=1\}$ {∈| ∥ ∥A ∈ $A\in\mathbb{S}^{n-1}$ note can Because the surface area of the unit sphere varies greatly with n, it is much easier in practice to work with the sure , which we denote $\mu_{1}[A]\bar{=}\,\mu[\dot{A}]/s_{n-1}$ . This normalized measure has the property that $\mu_{1}[\mathbb{S}^{n-1}]\,=\,1$ ,and so we can interpret $\mu_{1}[A]$ A as the probability of a uniform random point from the sphere lying in A .When working with points on a sphere, we often use geodesic distance, which is always somewhat larger than (but comparable to) the Euclidean distance. In the cube, we measure distance between points using $\ell_{p}$ -norms, which are denoted  

$$
\|z\|_{p}=\left(\sum_{i}|z_{i}|^{p}\right)^{1/p}\,\mathrm{if}\,p>0,\,\mathrm{and}\,\|z\|_{0}=\mathrm{card}\{z_{i}\,|\,z_{i}\neq0\}.
$$  

Note that $\|\cdot\|_{p}$ not truly a norm for $p<1$ ,but rather a semi-norm. Such metrics are still commonly used, particularly the “ ${}^{\bullet\epsilon}\ell_{0}$ -norm” which counts the number of non-zero entries in a vector.  

# 2 PROBLEM SETUP  

We consider the problem of classifying data points that lie in a space $\Omega$ (either a sphere or a hypercube) into $m$ bject classes. The $m$ object class are defined by probability density f ctions $\{\rho_{c}\}_{c=1}^{m}$ ,where $\rho_{c}:\Omega\,\rightarrow\,\mathbb{R}$ →. A “random” point from class cis a random variable with density $\rho_{c}$ .We assume $\rho_{c}$ to be bounded (i.e., we don’t allow delta functions or other generalized functions), and denote its upper bound by $U_{c}=\operatorname*{sup}_{x}\rho_{c}(x)$ .  

We also consider a “classifier” function $\mathcal{C}:\Omega\to\{1,2,\ldots,m\}$ that partitions $\Omega$ into disjoint measurable subsets, one for each class label. The classifier we consider is discrete valued – it provides a label for each data point but not a confidence level.  

With this setup, we can give a formal definition of an adversarial example.  

Definition 1. Consider a point $x\,\in\,\Omega$ draw from class $c$ ,a scalar $\epsilon>\,0$ ,an $d$ .W$x$ admits an ϵ-adversarial example in the metric dif there exists a point $\hat{x}\in\Omega$ ∈with C${\mathcal{C}}({\hat{x}})\neq c$ ̸and $d(x,{\hat{x}})\leq\epsilon$ ≤ϵ.  

In plain words, a point has an $\epsilon$ -adversarial example if we can sneak it into a different class by moving it at most $\epsilon$ units in the distance $d$ .  

We consider adversarial examples with respect to different $\ell_{p}$ -norm metrics. These metrics are written $d_{p}(x,{\hat{x}})\,=\,\|x\,-\,{\hat{x}}\|_{p}$ .A mmon cho e is $p\,=\,\infty$ ,which limits the absolute change that can be made to any one pixel. However, $\ell_{2}$ -norm and $\ell_{1}$ -norm adversarial examples are also used, as it is frequently easier to create adversarial examples in these less restrictive metrics.  

![](images/bbc9e99fcad2768a9e8a66097c55bcb685c74504a500376c96af730aab803dd3.jpg)  
Figure 3: The $\epsilon$ -expansion of a half sphere nearly covers the whole sphere for small $\epsilon$ and large $n$ . Visualizations show the fraction of the sphere captured within $\epsilon$ units of a half sphere in different dimensions. Results from a near-exact experimental method are compared to the theoretical lower bound in Lemma 2.  

We also consider sparse adversarial examples in which only a small subset of pixels are manipulated. This corresponds to the metric $d_{0}$ ,in hich case the constraint $\|x-\hat{x}\|_{0}\leq\epsilon$ means that an adversarial example was crafted by changing at most ϵpixels, and leaving the others alone.  

# 3 THE SIMPLE CASE :ADVERSARIAL EXAMPLES ON THE UNIT SPHERE  

We begin by looking at the case of classifiers for data on the sphere. While this data model may be less relevant than the other models studied below, it provides a straightforward case where results can be proven using simple, geometric lemmas. The more realistic case of images with pixels in [0 ,1] will be studied in Section 4.  

The idea is to show that, provided a class of data points takes up enough space, nearly every point in the class lies close to the class boundary. To show this, we begin with a simple definition.  

Definition 2. The $\epsilon$ -expan ion of a subset ${\mathcal{A}}\subset{\Omega}$ with respect to distance metric $d$ ,denoted $A(\epsilon,d)$ ,contains all points that are at most ϵunits away from A . To be precise  

$$
A(\epsilon,d)=\{x\in\Omega\,|\,d(x,y)\leq\epsilon\,f o r\,s o m e\,y\in{\mathcal{A}}\}.
$$  

We sometimes simply write $A(\epsilon)$ when the distance metric is clear from context.  

Our result provides bounds on the probability of adversarial examples that are independent of the shape of the class boundary. This independence is a simple consequence of an isoperimetric inequality . The classical isoperimetric inequality states that, of all closed surfaces that enclose a unit volume, the sphere has the smallest surface area. This simple fact is intuitive but famously difficult to prove. For a historical review of the isoperimetric inequality and its variants, see Osserman et al. (1978). We will use a special variant of the isoperimetric inequality first proved by L´evy & Pellegrino (1951) and simplified by Talagrand (1995).  

Lemma easure $\mu_{1}({\mathcal{A}})\,\geq\,1/2$ A ≥ic inequality) . When using the geodesic metric, the .Consider a subset of th ϵ-expansion sphere $A\,\subset\,\mathbb{S}^{n-1}\,\subset\,\mathbb{R}^{n}$ A $\mathcal{A}(\epsilon)$ is at least as large as the with normalized ϵ-expansion of a half sphere.  

The classical isoperimetric inequality is a simple geometric statement, and frequently appears without absolute bounds on the size of the $\epsilon$ -expansion of a half-sphere, or with bounds that involve unspecified constants (Vershynin, 2017). A tight bound derived by Milman $\&$ Schechtman (1986) is given below. The asymptotic blow-up of the $\epsilon$ -expansion of a half sphere predicted by this bound is shown in Figure 3.  

Lemma 2 ($\epsilon$ -expansion of half sphere) .The geodesic $\epsilon$ -expansion of a half sphere has normalized measure at least  

$$
1-\left({\frac{\pi}{8}}\right)^{\frac{1}{2}}\exp\left(-{\frac{n-1}{2}}\epsilon^{2}\right).
$$  

Lemmas 1 and 2 together can be taken to mean that, if a set is not too small, then in high dimensions almost all points on the sphere are reachable within a short $\epsilon$ jump from that set. These lemmas have immediate implications for adversarial examples, which are formed by mapping one class into another using small  

perturbations. Despite its complex appearance, the result below is a consequence of the (relatively simple) isoperimetric inequality.  

Theorem 1 (Existence of Adversarial Examples) .Consider a classification problem with mobject classes, it sphere $\mathbb{S}^{n-1}\subset\overline{{\mathbb{R}}}^{n}$ with density functions $\{\rho_{c}\}_{c=1}^{m}$ . Choose a classifier function ${\mathcal{C}}:\mathbb{S}^{n-1}\to\{1,2,\dots,m\}$ scalar constants: C→{ }that partitions the sphere into disjoint measurable subsets. Define the following  

•Let $V_{c}$ the supremum of $\rho_{c}$ relative to the uniform density. This can be written $V_{c}:=s_{n-1}\cdot\operatorname*{sup}_{x}\rho_{c}(x)$ −·.•Let $f_{c}=\mu_{1}\{x|{\mathcal{C}}(x)=c\}$ be the fraction of the sphere labeled as cby classifier $\mathcal{C}$ .  

Choose some class cwith $f_{c}\leq\frac{1}{2}$ . Sample a random data point $x$ from $\rho_{c}$ .Then with probability at least  

$$
1-V_{c}\left(\frac{\pi}{8}\right)^{\frac{1}{2}}\exp\left(-\frac{n-1}{2}\epsilon^{2}\right)
$$  

one of the following conditions holds:  

1. xis misclassified by $\mathcal{C}$ ,or   
2. xadmits an $\epsilon$ -adversarial example in the geodesic distance.  

Proo Choose class $c$ with $f_{c}\leq\frac{1}{2}$ .Let $\mathcal{R}=\{x|\mathcal{C}(x)=c\}$ de te the region of the sphere labele as class $c$ by C, and let Rbe its complement. $\overline{{\mathcal{R}}}(\epsilon)$ is the $\epsilon$ -expansion of Rin the geodesic metric. Because Rcovers at least half the sphere, the isoperimetric inequality (Lemma 1) tells us that the epsilon expansion is at least as great as the epsilon expansion of a half sphere. We thus have  

$$
\mu_{1}[\overline{{{R}}}(\epsilon)]\geq1-\left(\frac{\pi}{8}\right)^{\frac{1}{2}}\exp\left(-\frac{n-1}{2}\epsilon^{2}\right).
$$  

Now, consider the set $\mathcal{S}_{c}$ of “safe” points from class $c$ that are corr ly classified and do not ad t adversarial perturbations. A point is correctly classified only if it li s inside R,and therefore outside of R. To be safe from adversarial perturbations, a point cannot lie within ϵdistance from the class boundary, and so it cannot lie within $\overline{{R}}(\epsilon)$ . It is clear that the set $\ensuremath{\mathcal{S}}_{c}$ of safe points is exactly the complement of $\dot{\overline{{R}}}(\epsilon)$ .This set has normalized measure  

$$
\mu_{1}[S_{c}]\leq\left(\frac{\pi}{8}\right)^{\frac{1}{2}}\exp\left(-\frac{n-1}{2}\epsilon^{2}\right).
$$  

The probability of a point lying in $\ensuremath{\mathcal{S}}_{c}$ is bounded above by the normalized supremum of $\rho_{c}$ times the normalized measure $\mu_{1}[S_{c}]$ S.This product is given by  

$$
V_{c}\left(\frac{\pi}{8}\right)^{\frac{1}{2}}\exp\left(-\frac{n-1}{2}\epsilon^{2}\right).
$$  

We then subtract this probability from 1 to obtain the probability of a point lying outside the safe region, and arrive at equation 1.  

In the above result, we measure the size of adversarial perturbations using the geodesic distance. Most studies of adversarial examples measure the size of perturbation in either the $\ell_{2}$ (Euclidean) norm or the $\ell_{\infty}$ (max) norm, and so it is natural to wonder whether Theorem 1 depends strongly on the distance metric. Fortunately (or, rather unfortunately) it does not.  

It is easily observed that, for any two points $x$ and $y$ on a sphere,  

$$
d_{\infty}(x,y)\leq d_{2}(x,y)\leq d_{g}(x,y),
$$  

where $d_{\infty}(x,y),\,d_{2}(x,y)$ , and $d_{g}(x,y)$ denote the $l_{\infty}$ , Euclidean, and geodesic distance, respectively. From this, we see that Theorem 1 is actually fairly conservative; any $\epsilon$ -adversarial example in the geodesic metric would also be adversarial in the other two metrics, and the bound in Theorem 1 holds regardless of which of the three metrics we choose (although different values of $\epsilon$ will be appropriate depending on the norm).  

The above result about the sphere is simple and easy to prove using classical results. However, real world images do not lie on the sphere. In a more typical situation, images will be scaled so that their pixels lie in [0 ,1] , and data lies inside a high-dimensional hypercube (but, unlike the sphere, data is not confined to its surface). The proof of Theorem 1 makes extensive use of properties that are exclusive to the sphere, and is not applicable to this more realistic setting. Are there still problem classes on the cube where adversarial examples are inevitable?  

This question is complicated by the fact that geometric isoperimetric inequalities do not exist for the cube, as the shapes that achieve minimal $\epsilon$ -expansion (if they exist) depend on the volume they enclose and the choice of $\epsilon$ (Ros, 2001). Fortunately, researchers have been able to derive “algebraic” isoperimetric inequalities that provide lower bounds on the size of the $\epsilon$ -expansion of sets without identifying the shape that achieves this minimum (Talagrand, 1996; Milman & Schechtman, 1986). The result below about the unit cube is analogous to Proposition 2.8 in Ledoux (2001), except with tighter constants. For completeness, a proof (which utilizes methods from Ledoux) is provided in Appendix A.  

Lemma 3 (Isoperimetric inequality on a cube) .Consider a measurable subset of the cube $A\subset[0,1]^{n}$ ,and a $p$ -norm distance metric $d_{p}(x,y)=\|x-y\|_{p}$ for $p>0$ .Let $\begin{array}{r}{\Phi(z)=(2\pi)^{-\frac{1}{2}}\int_{-\infty}^{z}e^{-t^{2}/2}d t}\end{array}$ Rand let $\alpha$ be the scalar that satisfies $\Phi(\alpha)=\mathrm{vol}[A]$ .Then −∞  

$$
\mathrm{vol}[A(\epsilon,d_{p})]\ge\Phi\left(\alpha+\frac{\sqrt{2\pi n}}{n^{1/p^{*}}}\epsilon\right)
$$  

where $p^{*}=\operatorname*{min}(p,2)$ .In particular, $i f\operatorname{vol}(A)\geq1/2$ ,then we simply have  

$$
\mathrm{vol}[A(\epsilon,d_{p})]\ge1-\frac{\exp(-2\pi n^{1-2/p^{*}}\epsilon^{2})}{2\pi\epsilon n^{1/2-1/p^{*}}}.
$$  

Using this result, we can show that most data samples in a cube admit adversarial examples, provided the data distribution is not excessively concentrated.  

Theorem 2 (Adversarial examples on the cube) .Consider a classification problem with mclasses, each ypercube $[0,1]^{n}$ with density functions $\{\rho_{c}\}_{c=1}^{m}$ . Choose a classifier function $\mathcal{C}:[0,1]^{n}\rightarrow\{1,2,...\,,m\}$ Clowing scalar constants: →{ }that partitions the hypercube into disjoint measurable subsets. Define the fol  

•Let $U_{c}$ denote the supremum of $\rho_{c}$ .  
•Let $f_{c}$ be the fraction of hypercube partitioned into class cby $\mathcal{C}$ .  

Choose some class $c$ with $f_{c}\,\leq\,{\frac{1}{2}}$ ,and select an $\ell_{p}$ -norm with $p\,>\,0$ . Define $p^{*}=\operatorname*{min}(p,2)$ .Sample a random data point xfrom the class distribution $\rho_{c}$ .Then with probability at least  

$$
1-U_{c}\frac{\exp(-2\pi n^{1-2/p^{*}}\epsilon^{2})}{2\pi\epsilon n^{1/2-1/p^{*}}}.
$$  

one of the following conditions holds:  

1. xis misclassified by $\mathcal{C}$ ,or   
2. xhas an adversarial example $\hat{x}$ ,with $\|x-\hat{x}\|_{p}\leq\epsilon$ .  

When adversarial examples are defined in the $\ell_{2}$ -norm (or for any $p\geq2$ ), the bound in equation 4 becomes  

$$
1-U_{c}\exp(-2\pi\epsilon^{2})/(2\pi\epsilon).
$$  

Provided the class distribution is not overly concentrated, equation 5 guarantees adversarial examples with relatively “small” $\epsilon$ rela ical vector. In $n$ dimensions, the $\ell_{2}$ dr of the cube is $\sqrt{n}$ ,and so it is reasonable to choose $\epsilon=O({\sqrt{n}})$ in equation 5. In Figure 1, we chose $\epsilon=10$ .A similarly strong bound of $1-U_{c}\sqrt{n}\exp(-2\pi\epsilon^{2}/n)/(2\bar{\pi}\dot{\epsilon})$ −holds for the case of the $\ell_{1}$ -norm, in which case the diameter is $n$ .  

Oddly, equation 4 seems particularly weak when the $\ell_{\infty}$ norm is used. In this case, the bound on the right side of equation 4 bec quation 5 just like in the $\ell_{2}$ case. However, $\ell_{\infty}$ adversarial examples are only interesting if we take $\epsilon<\,1$ , in which case equation 5 becomes vacuous for large $n$ . This bound can be tightened up in certain situations. If we prove Theorem 2 using the tighter (but messier) bound of equation 2 instead of equation 3, we can replace equation 4 with  

$$
1-U_{c}\hat{\Phi}\left(\alpha+\sqrt{2\pi}\epsilon\right)
$$  

for $p\geq2$ ,where $\begin{array}{r}{\hat{\Phi}(z)\,=\,\frac{1}{\sqrt{2\pi}}\int_{z}^{\infty}e^{-t^{2}/2}d t\,\ge\,\frac{1}{\sqrt{2\pi}z}e^{-z^{2}/2}}\end{array}$ (for $z\,>\,0$ ), and $\alpha\,=\,\Phi^{-1}(1-f_{c})$ . For this bound to be meaningful with $\epsilon<1$ , we need $f_{c}$ to be relatively small, and $\epsilon$ to be roughly $f_{c}$ or smaller. This is realistic for some problems; ImageNet has 1000 classes, and so $f_{c}<10^{-3}$ for at least one class.  

Interestingly, under $\ell_{\infty}$ -norm attacks, guarantees of adversarial examples are much stronger on sphere (Section 3) than on the cube. One might wonder whether the weakness of Theorem 4 in the fundamental, or if this is a failure of our approach. One can construct examples of sets with $\ell_{\infty}$ ℓ$\ell_{\infty}$ expansions ∞case is that nearly match the behavior of equation 5, and so our theorems in this case are actually quite tight. It seems to be inherently more difficult to prove the existence of adversarial examples in the cube using the $\ell_{\infty}$ -norm.  

# 5 WHAT ABOUT SPARSE ADVERSARIAL EXAMPLES ?  

A number of papers have looked at sparse adversarial examples, in which a small number of image pixels, in some cases only one ( $\operatorname{Su}$ et al., 2017), are changed to manipulate the class label. To study this case, we would like to investigate adversarial examples under the $\ell_{0}$ metric. The $\ell_{0}$ distance is defined as  

$$
d(x,y)=\|x-y\|_{0}=\operatorname{card}\{i\mid x_{i}\neq y_{i}\}.
$$  

If a point $x$ has an $\epsilon$ -adversarial example in this norm, then it can be perturbed into a different class by modifying at most $\epsilon$ pixels (in this case $\epsilon$ is taken to be a positive integer).  

Theorem 2 is fairly tight for $p\,=\,1$ or 2 . However, the bound becomes quite loose for small $p$ ,and in particular it fails completely for the important case of $p=0$ .For this reason, we present a different bound that is considerably tighter for small $p$ (although slightly looser for large $p$ ).  

The case $p=0$ was studied by Milman & Schechtman (1986) (Section 6.2) and McDiarmid (1989), and later by Talagrand (1995; 1996). The proof of the following theorem (appendix B) follows the method used in Section 5 of Talagrand (1996), with modifications made to extend the proof to arbitrary $p$ .  

a 4 (Is perimetric inequality o $p$ .Cons measurable subset of the cube $A\subset$ $[0,1]^{n}$ ,and a p-norm distance metric $d(x,y)=\lVert x-y\rVert_{p}$ ∥−∥for any $p\geq0$ ≥.We have  

$$
\begin{array}{l}{\mathrm{vol}[A(\epsilon,d_{p})]\ge1-\frac{\exp\left(-\epsilon^{2p}/n\right)}{\mathrm{vol}[A]},f o r\,p>0\;a n d}\\ {\mathrm{vol}[A(\epsilon,d_{0})]\ge1-\frac{\exp\left(-\epsilon^{2}/n\right)}{\mathrm{vol}[A]},f o r\,p=0.}\end{array}
$$  

Using this result, we can prove a statement analogous to Theorem 2, but for sparse adversarial examples. We present only the case of $p\,=\,0$ ,but the generalization to the case of other small $p$ using Lemma 4 is straightforward.  

Theorem 3 (Sparse adversarial examples) .Consider the problem setup of Theorem 2. Choose some class cwith $f_{c}\leq\frac{1}{2}$ , and sample a random data point $x$ from the class distribution $\rho_{c}$ .Then with probability at least  

$$
1-2U_{c}\exp(-\epsilon^{2}/n)
$$  

one of the following conditions holds:  

1. xis misclassified by $\mathcal{C}$ ,or   
2. xcan be adversarially perturbed by modifying at most ϵpixels, while still remaining in the unit hypercube.  

# 6 WHAT IF WE JUST SHOW THAT ADVERSARIAL EXAMPLES EXIST ?  

Tighter bounds can be obtained if we only guarantee that adversarial examples exist for some data points in a class, without bounding the probability of this event.  

Theorem 4 (Condition for existence of adversarial examples) .Consider the setup of Theorem 2. Choose a class cthat occupies a fraction of the cube $f_{c}<\frac{1}{2}$ .Pick an $\ell_{p}$ norm and set $p^{*}=\operatorname*{min}(p,2)$ .  

Let $\operatorname{supp}(\rho_{c})$ denote the support of $\rho_{c}$ .Then there is a point $x$ with $\rho_{c}({\boldsymbol{x}})>0$ that admits an ϵ-adversarial example if  

$$
\begin{array}{r}{\mathrm{vol}[\mathrm{supp}(\rho_{c})]\ge\left\{\begin{array}{l l}{\frac{1}{2}\exp(-\pi\epsilon^{2}n^{1-2/p^{*}}),}&{\mathrm{~}f o r\,p>0\,o r}\\ {\exp\left(-2\left(\epsilon-\sqrt{\frac{n\log2}{2}}\right)^{2}/n\right),}&{\mathrm{~}f o r\,p=0.}\end{array}\right.}\end{array}
$$  

The bound for the case $p=0$ is valid only if $f\epsilon\geq\sqrt{n\log{2/2}}$ ≥.  

bound be It is interesting to consider when Theorem 4 produces non-vacuous bounds. When the $\mathrm{vol}[\mathrm{supp}(\rho_{c})]\geq\exp(-\pi\epsilon^{2})\hat{/}2$ .The diameter of the cube is $\sqrt{n}$ ,and so the bound becomes $\ell_{2}$ -norm is used, the $\epsilon=\sqrt{n}$ gging this in, we see that the boun is active whenever the size of t e support satisfies $\begin{array}{r}{\mathrm{vol}[\mathrm{supp}(\rho_{c})]>\frac{1}{2e^{\pi n}}}\end{array}$ .Remarkably, this holds for large nwhenever the support of class cis larger than (or contains) a hypercube of side length at least $e^{-\pi}\approx0.043$ .It is import nt note, however, that the bound being “active” does not mean there are adversarial examples with a “small” ϵ.  

# 7 DISCUSSION : C AN WE ESCAPE FUNDAMENTAL BOUNDS ?  

There are a number of ways to escape the guarantees of adversarial examples made by Theorems 1-4. One potential escape is for the class density functions to take on extremely large values (i.e., exponentially large $U_{c},$ ); the dependence of $U_{c}$ on $n$ is addressed separately in Section 8.  

Unbounded density functions and low-dimensional data manifolds In practice, image datasets might lie on low-dimensional manifolds within the cube, and the support of these distributions could have measure zero, making the density function infinite (i.e., ${\cal U}_{c}\,=\,\infty,$ ). The arguments above are still relevant (at least in theory) in this case; we can expand the data manifold by adding a uniform random noise to each image pixel of magnitude at most $\epsilon_{1}$ .The expanded dataset has positive volume. Then, adversarial examples of this expanded dataset can be crafted with perturbations of size $\epsilon_{2}$ . This method of expanding the manifold before crafting adversarial examples is often used in practice. Tram\`er et al. (2017a) proposed adding a small perturbation to step off the image manifold before crafting adversarial examples. This strategy is also used during adversarial training (Madry et al., 2017).  

Adding a “don’t know” class The analysis above assumes the classifier assigns a label to every point in the cube. If a classifier has the ability to say “I don’t know,” rather than assign a label to every input, then the region of the cube that is assigned class labels might be very small, and adversarial examples could be escaped even if the other assumptions of Theorem 4 are satisfied. In this case, it would still be easy for the adversary to degrade classifier performance by perturbing images into the “don’t know” class.  

Feature squeezing If decreasing the dimensionality of data does not lead to substantially increased values for $U_{c}$ (we see in Section 8 that this is a reasonable assumption) or loss in accuracy (a stronger assumption), measuring data in lower dimensions could increase robustness. This can be done via an auto-encoder (Meng & Chen, 2017; Shen et al., 2017), JPEG encoding (Das et al., 2018), or quantization (Xu et al., 2017).  

Computational hardness It may be computationally hard to craft adversarial examples because of local flatness of the classification function, obscurity of the classifier function, or other computational difficulties. Computational hardness could prevent adversarial attacks in practice, even if adversarial examples still exist.  

# 8 EXPERIMENTS & E FFECT OF DIMENSIONALITY  

In this section, we discuss the relationship between dimensionality and adversarial robustness, and explore how the predictions made by the theorems above are reflected in experiments.  

It is commonly thought that high-dimensional classifiers are more susceptible to adversarial examples than low-dimensional classifiers. This perception is partially motivated by the observation that classifiers on highresolution image distributions like ImageNet are more easily fooled than low resolution classifiers on MNIST (Tram\`er et al., 2017a). Indeed, Theorem 2 predicts that high-dimensional classifiers should be much easier to fool than low-dimensional classifiers, assuming the datasets they classify have comparable probability density limits $U_{c}$ .However, this is not a reasonable assumption; we will see below that high dimensional distributions may be more concentrated than their low-dimensional counterparts.  

We study the effects of dimensionality with a thought experiment involving a “big MNIST” image distribution. Given an integer expansion factor $b$ ,we can make a big MNIST distribution, denoted $b$ -MNIST, by g each pixel IST image with a $b\times b$ array of identical pixels. This expands an original $28\times28$ MNIST is far more susceptible to attacks than a classifier trained on the original MNIST ×image into a $28b\times28b$ ×image. Figure 4a shows that, without adversarial training, a classifier on big 1 .  

However, each curve in Figure 4a only shows the attack susceptibility of one particular classifier. In contrast, Theorems 1-4 describe the fundamental limits of susceptibility for all classifiers. These limits are an inherent property of the data distribution. The theorem below shows that these fundamental limits do not depend in a non-trivial way on the dimensionality of the images in big MNIST, and so the relationship between dimensionality and susceptibility in Figure 4a results from the weakness of the training process.  

Theorem 5. Suppose ϵand pare such that, for all MNIST classifiers, a random image from class chas an $\epsilon$ -adversarial example (in the $\ell_{2}$ -norm) with probability at least $p$ . Then for all classifiers on $b$ -MNIST, with integer $b\geq1$ ,a random image from chas a bϵ -adversarial example with probability at least $p$ .  

Likewise, if all $b$ -MNIST classifiers have bϵ -adversa ial examples with probability $p$ for som $b\geq1$ , then all classifiers on the original MNIST distribution have ϵ-adversarial examples with probability p.  

Th predicts that the perturbation needed to ol all $56\times56$ sifiers is twice that neede all counterpart. Put simply, fooling big MNIST is just as hard/easy as fooling the original MNIST regardless $28\times28$ ×classifiers. This is reasonable since the $\ell_{2}$ -norm of a $56\times56$ ×image is twice that of its $28\times28$ ×of resolution. This also shows that for big MNIST, as the expansion factor $b$ gets larger and $\epsilon$ is expanded to match, the concentration bound $U_{c}$ grows at exactly the same rate as the exponential term in equation 2 shrinks, and there is no net effect on fundamental susceptibility. Also note that an analogous result could be based on any image classification problem (we chose MNIST only for illustration), and any $p\geq0$ .  

We get a better picture of the fundamental limits of MNIST by considering classifiers that are hardened by adversarial training 2 (Figure 4b). These curves display several properties of fundamental limits predicted by our theorems. As predicted by Theo he $112\times112$ classifer curve is twice as wide as the $56\times56$ curve, predicted by Theorem 2, in which the classifier suddenly changes from being highly robust to being highly which in turn is twice as wide as the $28\times28$ ×curve. In addition, we see the kind of “phase transition” behavior susceptible as $\epsilon$ passes a critical threshold. For these reasons, it is reasonable to suspect that the adversarially trained classifiers in Figure 4b are operating near the fundamental limit predicted by Theorem 2.  

Theorem 5 shows that increased dimensionality does not increase adversarial susceptibility in a fundamental way. But then why are high-dimensional classifiers so easy to fool? To answer this question, we look at the concentration bound $U_{c}$ for object classes. The smallest possible value of $U_{c}$ is 1, which only occurs when images are “spread out” with uniform, uncorrelated pixels. In contrast, adjacent pixels in MNIST (and especially big MNIST) are very highly correlated, and images are concentrated near simple, low-dimensional manifolds, resulting in highly concentrated image classes with large $U_{c}$ . Theory predicts that such highly concentrated datasets can be relatively safe from adversarial examples.  

![](images/a292519b0f669ac09a66aa4adaada4ee20a4a298107a85835d1a9cc68e72dbac.jpg)  
Figure 4: (a) Robustness of MNIST and “big” MNIST classifiers as a function of $\epsilon$ . Naturally trained classifiers are less robust with increased dimensionality. (b) With adversarial training, susceptibility curves behave as predicted by Theorems 2 and 5. (c) The susceptibility of CIFAR-10 is compared to big MNIST. Both datasets have similar dimension, but the higher complexity of CIFAR-10 results in far worse susceptibility. Perturbations are measured in the $\ell_{2}$ -norm.  

We can reduce $U_{c}$ and dramatically increase susceptibility by choosing a more “spread out” dataset, like CIFAR-10, in which adjacent pixels are less strongly correlated and images appear to concentrate near complex, higher-dimensional manifolds. We observe the effect of decreasing $U_{c}$ by plotting the susceptibility of a $56\times56$ MNIST classifier against a classifier for CIFAR-10 (Figure 4, right). The former problem lives in 3136 dimensions, while the latter lives in 3072 ,and both have 10 classes. Despite the structural similarities between these problems, the decreased concentration of CIFAR-10 results in vastly more susceptibility to attacks, regardless of whether adversarial training is used. The theory above suggests that this increased susceptibility is caused at least in part by a shift in the fundamental limits for CIFAR-10, rather than the weakness of the particular classifiers we chose.  

Informally, the concentration limit $U_{c}$ can be interpreted as a measure of image complexity . Image classes with smaller $U_{c}$ are likely concentrated near high-dimensional complex manifolds, have more intra-class variation, and thus more apparent complexity. An informal interpretation of Theorem 2 is that “high complexity” image classes are fundamentally more susceptible to adversarial examples, and Figure 4 suggests that complexity (rather than dimensionality) is largely responsible for differences we observe in the effectiveness of adversarial training for different datasets.  

# 9 SO... ARE ADVERSARIAL EXAMPLES INEVITABLE ?  

The question of whether adversarial examples are inevitable is an ill-posed one. Clearly, any classification problem has a fundamental limit on robustness to adversarial attacks that cannot be escaped by any classifier. However, we have seen that these limits depend not only on fundamental properties of the dataset, but also on the strength of the adversary and the metric used to measure perturbations. This paper provides a characterization of these limits and how they depend on properties of the data distribution. Unfortunately, it is impossible to know the exact properties of real-world image distributions or the resulting fundamental limits of adversarial training for specific datasets. However, the analysis and experiments in this paper suggest that, especially for complex image classes in high-dimensional spaces, these limits may be far worse than our intuition tells us.  

T. Goldstein and his students were generously supported by DARPA Lifelong Learning Machines (FA8650- 18-2-7833), the Office of Naval Research (N00014-17-1-2078), the DARPA Young Faculty Award program (D18AP00055), and the Sloan Foundation. The work of C. Studer was supported in part by Xilinx Inc., and by the US NSF under grants ECCS-1408006, CCF-1535897, CCF-1652065, and CNS-1717559.  

# REFERENCES  

Milton Abramowitz and Irene A Stegun. Handbook of mathematical functions: with formulas, graphs, and mathematical tables , volume 55. Courier Corporation, 1965.   
Anish Athalye and Ilya Sutskever. Synthesizing robust adversarial examples. arXiv preprint arXiv:1707.07397 , 2017.   
Anish Athalye, Nicholas Carlini, and David Wagner. Obfuscated gradients give a false sense of security: Circumventing defenses to adversarial examples. arXiv preprint arXiv:1802.00420 , 2018.   
Battista Biggio, Igino Corona, Davide Maiorca, Blaine Nelson, Nedim Srndi´c, Pavel Laskov, Giorgio Giacinto, and Fabio Roli. Evasion attacks against machine learning at test time. In Joint European conference on machine learning and knowledge discovery in databases , pp. 387–402. Springer, 2013.   
Sergey G Bobkov et al. An isoperimetric inequality on the discrete cube, and an elementary proof of the isoperimetric inequality in gauss space. The Annals of Probability , 25(1):206–214, 1997.   
Jacob Buckman, Aurko Roy, Colin Raffel, and Ian Goodfellow. Thermometer encoding: One hot way to resist adversarial examples. OpenReview , 2018.   
Nicholas Carlini and David Wagner. Defensive distillation is not robust to adversarial examples. arXiv preprint arXiv:1607.04311 , 2016.   
Nicholas Carlini and David Wagner. Magnet and “efficient defenses against adversarial attacks” are not robust to adversarial examples. arXiv preprint arXiv:1711.08478 , 2017a.   
Nicholas Carlini and David Wagner. Towards evaluating the robustness of neural networks. In Security and Privacy (SP), 2017 IEEE Symposium on , pp. 39–57. IEEE, 2017b.   
Nilaksh Das, Madhuri Shanbhogue, Shang-Tse Chen, Fred Hohman, Siwei Li, Li Chen, Michael E Kounavis, and Duen Horng Chau. Shield: Fast, practical defense and vaccination for deep learning using JPEG compression. arXiv preprint arXiv:1802.06816 , 2018.   
Guneet S Dhillon, Kamyar Azizzadenesheli, Zachary C Lipton, Jeremy Bernstein, Jean Kossaifi, Aran Khanna, and Anima Anandkumar. Stochastic activation pruning for robust adversarial defense. arXiv preprint arXiv:1803.01442 , 2018.   
Alhussein Fawzi, Hamza Fawzi, and Omar Fawzi. Adversarial vulnerability for any classifier. arXiv preprint arXiv:1802.08686 , 2018.   
Justin Gilmer, Luke Metz, Fartash Faghri, Samuel S Schoenholz, Maithra Raghu, Martin Wattenberg, and Ian Goodfellow. Adversarial spheres. arXiv preprint arXiv:1801.02774 , 2018.   
Ian J Goodfellow, Jonathon Shlens, and Christian Szegedy. Explaining and harnessing adversarial examples. arXiv preprint arXiv:1412.6572 , 2014.   
Chuan Guo, Mayank Rana, Moustapha Cisse, and Laurens van der Maaten. Countering adversarial images using input transformations. arXiv preprint arXiv:1711.00117 , 2017.   
J Zico Kolter and Eric Wong. Provable defenses against adversarial examples via the convex outer adversarial polytope. arXiv preprint arXiv:1711.00851 , 2017.   
Alexey Kurakin, Ian Goodfellow, and Samy Bengio. Adversarial examples in the physical world. arXiv preprint arXiv:1607.02533 , 2016.   
Michel Ledoux. The concentration of measure phenomenon . Number 89. American Mathematical Soc., 2001.   
Paul L´evy and Franco Pellegrino. Probl´emes concrets d’analyse fonctionnelle . Gauthier-Villars, Paris, 1951.   
Xingjun Ma, Bo Li, Yisen Wang, Sarah M Erfani, Sudanthi Wijewickrema, Michael E Houle, Grant Schoenebeck, Dawn Song, and James Bailey. Characterizing adversarial subspaces using local intrinsic dimensionality. arXiv preprint arXiv:1801.02613 , 2018.   
Aleksander Madry, Aleksandar Makelov, Ludwig Schmidt, Dimitris Tsipras, and Adrian Vladu. Towards deep learning models resistant to adversarial attacks. arXiv preprint arXiv:1706.06083 , 2017.   
Saeed Mahloujifar, Dimitrios I Diochnos, and Mohammad Mahmoody. The curse of concentration in robust learning: Evasion and poisoning attacks from concentration of measure. arXiv preprint arXiv:1809.03063 ,2018.   
C McDiarmid. On the method of bounded differences. London Mathematical Society Lecture Notes , 141: 148–188, 1989.  
Dongyu Meng and Hao Chen. MagNet: a two-pronged defense against adversarial examples. In Proceedings of the 2017 ACM SIGSAC Conference on Computer and Communications Security , pp. 135–147. ACM, 2017.   
Vitali D Milman and Gideon Schechtman. Asymptotic Theory of Finite Dimensional Normed Spaces .Springer-Verlag, Berlin, Heidelberg, 1986. ISBN 0-387-16769-2.   
Robert Osserman et al. The isoperimetric inequality. Bulletin of the American Mathematical Society , 84(6): 1182–1238, 1978.   
Nicolas Papernot, Patrick McDaniel, and Ian Goodfellow. Transferability in machine learning: from phenomena to black-box attacks using adversarial samples. arXiv preprint arXiv:1605.07277 , 2016a.   
Nicolas Papernot, Patrick McDaniel, Xi Wu, Somesh Jha, and Ananthram Swami. Distillation as a defense to adversarial perturbations against deep neural networks. In Security and Privacy (SP), 2016 IEEE Symposium on , pp. 582–597. IEEE, 2016b.   
Aditi Raghunathan, Jacob Steinhardt, and Percy Liang. Certified defenses against adversarial examples. arXiv preprint arXiv:1801.09344 , 2018.   
Antonio Ros. The isoperimetric problem. Global theory of minimal surfaces , 2:175–209, 2001.   
Pouya Samangouei, Maya Kabkab, and Rama Chellappa. Defense-GAN: Protecting classifiers against adversarial attacks using generative models. arXiv preprint arXiv:1805.06605 , 2018.   
Shiwei Shen, Guoqing Jin, Ke Gao, and Yongdong Zhang. APE-GAN: Adversarial perturbation elimination with GAN. ICLR Submission, available on OpenReview , 4, 2017.   
Carl-Johann Simon-Gabriel, Yann Ollivier, Bernhard Sch¨olkopf, L´eon Bottou, and David Lopez-Paz. Adversarial vulnerability of neural networks increases with input dimension. arXiv preprint arXiv:1802.01421 ,2018.   
Aman Sinha, Hongseok Namkoong, and John Duchi. Certifying some distributional robustness with principled adversarial training. OpenReview , 2018.   
Yang Song, Taesup Kim, Sebastian Nowozin, Stefano Ermon, and Nate Kushman. PixelDefend: Leveraging generative models to understand and defend against adversarial examples. arXiv preprint arXiv:1710.10766 , 2017.  

Jiawei Su, Danilo Vasconcellos Vargas, and Sakurai Kouichi. One pixel attack for fooling deep neural networks. arXiv preprint arXiv:1710.08864 , 2017.  

Vladimir Sudakov and Boris Tsirelson. Extremal properties of half-spaces for spherically invariant measures. J. Soviet Math. , 41, 1974.  

Christian Szegedy, Wojciech Zaremba, Ilya Sutskever, Joan Bruna, Dumitru Erhan, Ian Goodfellow, and Rob Fergus. Intriguing properties of neural networks. arXiv preprint arXiv:1312.6199 , 2013.  

Michel Talagrand. Concentration of measure and isoperimetric inequalities in product spaces. Publications Math´ematiques de l’Institut des Hautes Etudes Scientifiques , 81(1):73–205, 1995.  

Michel Talagrand. A new look at independence. The Annals of probability , pp. 1–34, 1996.  

Florian Tram\`er, Alexey Kurakin, Nicolas Papernot, Ian Goodfellow, Dan Boneh, and Patrick McDaniel. Ensemble adversarial training: Attacks and defenses. arXiv preprint arXiv:1705.07204 , 2017a.  

Florian Tram\`er, Nicolas Papernot, Ian Goodfellow, Dan Boneh, and Patrick McDaniel. The space of transferable adversarial examples. arXiv preprint arXiv:1704.03453 , 2017b.  

Roman Vershynin. High-Dimensional Probability . Cambridge University Press, 2017.  

Yizhen Wang, Somesh Jha, and Kamalika Chaudhuri. Analyzing the robustness of nearest neighbors to adversarial examples. International Conference of Machine Learning (ICML) , 2018.  

Cihang Xie, Jianyu Wang, Zhishuai Zhang, Zhou Ren, and Alan Yuille. Mitigating adversarial effects through randomization. arXiv preprint arXiv:1711.01991 , 2017.  

Weilin Xu, David Evans, and Yanjun Qi. Feature squeezing: Detecting adversarial examples in deep neural networks. arXiv preprint arXiv:1704.01155 , 2017.  

Valentina Zantedeschi, Maria-Irina Nicolae, and Ambrish Rawat. Efficient defenses against adversarial attacks. In Proceedings of the 10th ACM Workshop on Artificial Intelligence and Security , pp. 39–49. ACM, 2017.  

# A PROOF OF LEMMA 3  

We now prove Lemma 3. To do this, we begin with a classical isoperimetric inequality for random Gaussian variables. Unlike the case of a cube, tight geometric isoperimetric inequalities exist in this case. We then prove results about the cube by creating a mapping between uniform random variables on the cube and random Gaussian vectors.  

In the lemma below, we consider the standard Gaussian density in $\mathbb{R}^{n}$ given by $\begin{array}{r}{p(x)=\frac{1}{(2\pi)^{n/2}}e^{-n x^{2}/2}}\end{array}$ and corresponding Gaussian measure $\mu$ .We also define  

$$
\Phi(z)={\frac{1}{\sqrt{2\pi}}}\int_{-\infty}^{z}e^{-t^{2}/2}d t,
$$  

which is the cumulative density of a Gaussian curve.  

The following Lemma was first proved in Sudakov & Tsirelson (1974), and an elementary proof was given in Bobkov et al. (1997).  

Lemma 5 (Gaussian Isoperimetric Inequality) .Of all sets with the same Gaussian measure, the set with $\ell_{2}$ $\epsilon$ -expansion of small s a half space. Furthermore, for any measurable set $A\subset\mathbb{R}^{n}$ ,and scalar constant a such that $\Phi(a)=\mu[A]$ A ,  

$$
\mu[A(\epsilon,d_{2})]\geq\Phi(a+\epsilon).
$$  

Using this result we can now give a proof of Lemma 3.  

This function $\Phi$ maps a random Guassian $z\in N(0,I)$ onto a random unifor ctor n the unit cube. To see why, consider a measurable subset B ⊂ $B\subset R^{n}$ .If µis the Gaussian measure on R$\mathbb{R}^{n}$ and σis the uniform measure on the cube, then  

$$
\sigma[\Phi(B)]=\int\chi_{\Phi(B)}(s)d\sigma=\int\chi_{\Phi(B)}(\Phi(z))\frac{1}{\operatorname*{det}(J\Phi)}d z=\int\chi_{B}(z)d\mu=\mu[\mathcal{B}].
$$  

Since $\begin{array}{r}{\frac{\partial}{\partial z_{i}}\Phi(z)\leq\frac{1}{\sqrt{2\pi}}}\end{array}$ ,we also have  

$$
\|\Phi(z)-\Phi(w)\|_{p}\leq\|{\frac{1}{\sqrt{2\pi}}}(x-w)\|_{p}={\frac{1}{\sqrt{2\pi}}}\|z-w\|_{p}
$$  

for any $z,w\in\mathbb{R}^{n}$ .From this, we see that for $p^{*}=\operatorname*{min}(p,2)$  

$$
\|\Phi(z)-\Phi(w)\|_{p}\leq n^{1/p^{*}-1/2}\|\Phi(z)-\Phi(w)\|_{2}\leq\frac{n^{1/p^{*}}}{\sqrt{2\pi n}}\|z-w\|_{2}
$$  

where we have used the identity $\|u\|_{p}\leq n^{1/\operatorname*{min}(p,2)-1/2}\|u\|_{2}$ .  

Now, consider any set $\boldsymbol{\mathcal{A}}$ in the cube, and let $B=\Phi^{-1}(\mathcal{A})$ .From equation 10, we see that  

$$
\Phi\mathcal{B}\left(\frac{\sqrt{2\pi n}}{n^{1/p^{*}}}\epsilon,d_{2}\right)\subset\mathcal{A}(\epsilon,d_{p}).
$$  

It follows from equation 10 that  

$$
\sigma[A(\epsilon,d_{p})]\geq\mu\left[B\left(\frac{\sqrt{2\pi n}}{n^{1/p^{*}}}\epsilon,d_{2}\right)\right].
$$  

Applying Lemma 5, we see that  

$$
\sigma[A(\epsilon,d_{p})]\geq\Phi\left(\alpha+\frac{\sqrt{2\pi n}}{n^{1/p^{*}}}\epsilon\right)
$$  

where $\alpha=\Phi^{-1}(\sigma[A])$  

To obtain the simplified formula in the theorem, we use the identity  

$$
{\frac{1}{\sqrt{2\pi}}}\int_{x}^{\infty}e^{-t^{2}}d t<{\frac{e^{-x^{2}}}{\sqrt{2\pi}x}}
$$  

which is valid for $x>0$ ,and can be found in Abramowitz & Stegun (1965).  

# BPROOF OF LEMMA 4  

Our proof emulates the method of Talagrand, with modifications that extend the result to other $\ell_{p}$ norms. We need the following standard inequality. Proof can be found in Talagrand (1995; 1996).  

Lemma 6 (Talagrand) .Consider a probability space $\Omega$ with measure $\mu$ .For $g:\Omega\rightarrow[0,1]$ ,we have  

$$
\int_{\Omega}\operatorname*{min}\left(e^{t},{\frac{1}{g^{\alpha}}}\right)d\mu\;\times\;\left(\int_{\Omega}g d\mu\right)^{\alpha}\le\exp\left({\frac{t^{2}(\alpha+1)}{8\alpha}}\right).
$$  

Our proof of Lemma 3 follows the three-step process of Talagrand illustrated in Talagrand (1995). We begin by proving the bound  

$$
\int e^{t f(x,A)}d x\leq{\frac{1}{\sigma^{\alpha}[A]}}\exp\left({\frac{n t^{2}(\alpha+1)}{8\alpha}}\right)
$$  

where $\begin{array}{r}{f(x,\mathcal{A})\,=\,\operatorname*{min}_{y\in\mathcal{A}}\sum_{i}|x_{i}\,-\,y_{i}|^{p}\,=\,d_{p}^{p}(x,\mathcal{A})}\end{array}$ P−is a measure of distance from $\boldsymbol{\mathcal{A}}$ to $x$ , and $\alpha,t$ are arbitrary positive constants. Once this bound is established, a Markov bound can be used to obtain the final result. Finally, constants are tuned in order to optimize the tightness of the bound.  

We start by proving the bound in equation 12 using induction on the dimension. The base case for the induction is $n=1$ ,and we have  

$$
^{A)}d x\leq\sigma[A]+\int_{A^{c}}e^{t f(x,A)}d x\leq\sigma[A]+\int_{A^{c}}1d x\leq\sigma[A]+(1-\sigma[A])e^{t}\leq\frac{1}{\sigma^{\alpha}[A]}\exp\left(\frac{t^{2}(\alpha+1)}{8\alpha}\right)\,.
$$  

We now prove the result for $n$ dimensions using the inductive hypothesis. We can upper bound the integral by integrating over “slices” along one dimension. Let $A\subset[0,1]^{n}$ .Define  

$A_{\omega}=\{z\in\mathbb{R}^{n-1}\,|\,(\omega,z)\in\mathcal{A}\}$  

$$
{\mathcal{B}}=\{z\in\mathbb{R}^{n-1}\,|\,(\omega,z)\in{\mathcal{A}}\,{\mathrm{for~some}}\,\omega\}.
$$  

Clearly, the distance from $(\omega,z)$ to $\boldsymbol{\mathcal{A}}$ is at most the distance from $z$ to $\mathcal{A}_{\omega}$ ,and so  

$$
\int e^{t f(x,A)}d x\leq\int_{\omega\in[0,1]}\int_{z\in[0,1]^{n-1}}e^{t f(z,A_{\omega})}d z\,d x\leq\int_{\omega\in[0,1]}\frac{1}{\sigma^{\alpha}[A_{\omega}]}\exp\left(\frac{(n-1)t^{2}(\alpha+1)}{8\alpha}\right).
$$  

We also have that the distance from $x$ to $\boldsymbol{\mathcal{A}}$ is at most one unit greater than the distance from $x$ to $\boldsymbol{\mathrm{\Delta}}\boldsymbol{\mathrm{\Omega}}^{\beta}$ . This gives us  

$$
t f(x,A)\,d x\le\int_{(\omega,z)\in[0,1]^{n}}e^{t(f(x,B)+1)}\le e^{t}\int_{(\omega,z)\in[0,1]^{n}}e^{t f(x,B)}\le\frac{e^{t}}{\sigma^{\alpha}[B]}\exp\left(\frac{(n-1)t^{2}(\alpha+1)}{8\alpha}\right)
$$  

Applying equation 6 gives us  

$$
\begin{array}{r l}&{\int e^{t f(x,A)}d x\leq\int_{\omega\in[0,1]}\operatorname*{min}\left(\frac{e^{t}}{\sigma^{\alpha}[B]}\exp\left(\frac{(n-1)t^{2}(\alpha+1)}{8\alpha}\right),\frac{1}{\sigma^{\alpha}[A_{\omega}]}\exp\left(\frac{(n-1)t^{2}(\alpha+1)}{8\alpha}\right)\right.}\\ &{\qquad\qquad\qquad\qquad\left.=\exp\left(\frac{(n-1)t^{2}(\alpha+1)}{8\alpha}\right)\frac{1}{\sigma^{\alpha}[B]}\int_{\omega\in[0,1]}\operatorname*{min}\left(e^{t},\frac{\sigma^{\alpha}[B]}{\sigma^{\alpha}[A_{\omega}]}\right).}\end{array}
$$  

Now, we apply lemma 6 to equation 13 with $g(\omega)=\alpha[A_{\omega}]/\alpha[B]$ to arrive at equation 12.  

The second step of the proof is to produce a Markov inequality from equation 12. For the bound in equation 12 to hold, we need  

$$
1-\sigma[A(\epsilon,d_{p})]=\sigma\{x\mid f(x)>\epsilon^{p}\}\leq\frac{\int e^{t f(x,A)}d x}{e^{t\epsilon^{p}}}\leq\frac{\exp\left(\frac{n t^{2}(\alpha+1)}{8\alpha}\right)}{\sigma^{\alpha}[A]e^{t\epsilon^{p}}}.
$$  

The third step is to optimize the bound by choosing constants. We minimize the right hand side by choosing $\begin{array}{r}{t=\frac{4\alpha\epsilon^{p}}{n(\alpha+1)}}\end{array}$ to get  

$$
1-\sigma[A(\epsilon,d_{p})]\leq\frac{\exp\left(-\frac{2\alpha\epsilon^{2p}}{n(\alpha+1)}\right)}{\sigma^{\alpha}[A]}.
$$  

Now, we can simply choose $\alpha=1$ to get the simple bound  

$$
1-\sigma[A(\epsilon,d_{p})]\leq{\frac{\exp\left(-\epsilon^{2p}/n\right)}{\sigma[A]}},
$$  

or we can choose the optimal value of $\begin{array}{r}{\alpha=\sqrt{\frac{2\epsilon^{2p}}{n\log(1/\sigma)}}-1}\end{array}$ q,which optimizes the bound in the case $\epsilon^{2p}\geq$ $\textstyle{\frac{n}{2}}\log(1/\sigma(A))$ .We arrive at  

$$
1-\sigma[A(\epsilon,d_{p})]\leq\exp\left(-\frac{2}{n}\left(\epsilon^{p}-\sqrt{n\log(\sigma^{-1}[A])/2}\right)^{2}\right).
$$  

This latter bound is stronger than we need to prove Lemma 3, but it will come in handy later to prove Theorem 4.  

# CPROOF OF THEOREMS 2 AND 3  

We combine the proofs of these results since their proofs are nearly identical. The proofs closely follow the argument of Theorem 1.  

Choose a class $c$ with $f_{c}\ \leq\ \frac{1}{2}$ a let $\mathcal{R}\,=\,\{x|\mathcal{C}(x)\,=\,c\}$ denote the subset of the cube lying in clas $c$ covers at least half the cube, we can invoke Lemma 3. We have that according to the classifier C. Let Rbe the complement, who’s $\ell_{p}$ expansion is denoted $\overline{{\mathcal{R}}}(\epsilon;d_{p})$ . Because R  

$$
\begin{array}{r}{\mathrm{vol}[\overline{{\mathcal{R}}}(\epsilon;h)]\geq1-\delta,}\end{array}
$$  

where  

$$
\delta=\left\{\frac{\exp(-2\pi n^{1-2/p^{*}}\epsilon^{2})}{2\pi\epsilon n^{1/2-1/p^{*}}},\,\mathrm{for}\,\mathrm{Theorem}\,2\;\mathrm{and}\right.
$$  

region has volume at most The set $\overline{{\mathcal{R}}}(\epsilon;h)$ contains a δ, and the probability of a sample from the class distribution points that are correctly classified and safe from adversar $\rho_{c}$ lying in this region perturbations. This is at most $U_{c}\delta$ .We then subtract this from 1 to obtain the mass of the class distribution lying in the “unsafe” region $\overline{{\mathcal{R}}}_{c}$ .  

# DPROOF OF THEOREM 4  

Let $\boldsymbol{\mathcal{A}}$ denote the upport of $p_{c}$ ,an e that this support has measure $\operatorname{vol}[A]=\eta$ .We want to show that, for large enough ϵ, the expansio $A(\epsilon,d_{p})$ is larger than half the cube. Since class coccupies less than h with the c ϵ-adversarial examples. be, this would imply that A $A(\epsilon,d_{p})$ overlaps with other classes, and so there must be data points in A  

We start with the case $p>0$ ,where we bound $A(\epsilon,d_{p})$ using equation 2 of Lemma 3. To do this, we need to approximate $\Phi^{-1}(\eta)$ .This can be done using the inequality  

$$
\Phi(\alpha)=\frac{1}{2\pi}\int_{-\infty}^{\alpha}e^{-t^{2}/2}d t\le\frac{1}{2}e^{-\alpha^{2}/2},
$$  

which holds for $\alpha<0$ .Rearranging, we obtain  

$$
\alpha\geq-\sqrt{\log\frac{1}{4\Phi(\alpha)^{2}}}.
$$  

Now, if $\alpha=\Phi^{-1}(\eta)$ ,then $\Phi(\alpha)=\eta$ ,and equation 19 gives us $\begin{array}{r}{\alpha\geq-\sqrt{\log\frac{1}{4\eta^{2}}}}\end{array}$ q.Plugging this into equation 2 of Lemma 3, we get  

$$
\operatorname{vol}[A(\epsilon,d_{p})]\geq\Phi(\alpha+\epsilon)\geq\Phi\left(-\sqrt{\log\frac{1}{4\eta^{2}}}+\frac{\sqrt{2\pi n}}{n^{1/p^{*}}}\epsilon\right).
$$  

The quantity on the left will be greater than $\frac{1}{2}$ ,thus guaranteeing adversarial examples, if  

$$
\frac{\sqrt{2\pi n}}{n^{1/p^{*}}}\epsilon>\sqrt{\log\frac{1}{4\eta^{2}}}.
$$  

This can be re-arranged to obtain the desired result.  

In the case $p=0$ ,we need to use equation 17 from the proof of Lemma 3 in Appendix B, which we restate here  

$$
\operatorname{vol}[A(\epsilon,d_{0})]\geq1-\exp\left(-\frac{2}{n}\left(\epsilon-\sqrt{n\log(1/\eta)/2}\right)^{2}\right).
$$  

This bound is valid, and produces a non-vacuous guarantee of adversarial examples, if  

$$
\exp\left(-\frac{2}{n}\left(\epsilon-\sqrt{n\log(1/\eta)/2}\right)^{2}\right)<\frac{1}{2}.
$$  

which holds if  

$$
\eta>\exp\left(-\frac{2\left(\epsilon-\sqrt{n\log2/2}\right)^{2}}{n}\right).
$$  

# EPROOF OF THEOREM 5  

Assume that any MNIST classifier can be fooled by perturbations of size at most $\epsilon$ with probability at least $p$ .To begin, we put a bound on the susceptibility of any $b$ -MNIST cla $b\geq1$ ) under this assumption. We can classify MNIST images by upsampling them to resolution resolution “back-end” classifier. After upsampling, an MNIST image with perturbation of norm $28b\times28b$ ×and feeding them i ϵto a highbecomes a $28b\times28b$ image with perturbation of norm $b\epsilon$ .The classifier we have c nstructed takes low-resolution images as inputs, and so by assumption it is fooled with probability at least p. However, the low-resolution classifier is fooled only when the high-resolution “back-end” classifier is fooled, and so the high-resolution classifier is fooled with probability at least $p$ at well. Note that we can build this two-scale classifier using any high-resolution classifier as a back-end, and so this bound holds uniformly over all high-resolution classifiers.  

e, suppose we classify $b$ -MNIST images (for integer $b\geq1$ ) by downsampling them to the original $28\times28$ After downsampling, a ×resolution (by $28b\times28b$ ×image with perturbation of norm pixel blocks) and feeding them in bϵ a “back-en becomes a $28\times28$ ×esolution classifier. image with perturbation of norm at most ϵ. Whenever the high-resolution classifier is fooled, it is only because the back-end classifier is fooled by a perturbation of size at most $\epsilon$ ,and this happens with probability at least $p$ .  